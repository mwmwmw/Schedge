!function(t){var e={};function i(s){if(e[s])return e[s].exports;var r=e[s]={i:s,l:!1,exports:{}};return t[s].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(s,r,function(e){return t[e]}.bind(null,r));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){"use strict";i.r(e);let s={};class r{static on(t,e,i=s){void 0===i[t]?i[t]=[e]:i[t].push(e)}static off(t,e,i=s){if(i[t])for(let e=i[t].length-1;e>=0;e--){if(1!==i[t].length){i[t].splice(e,1);break}delete i[t]}}static trigger(t){var e=new Array(...arguments);e.splice(0,1),r.send(t,s,e)}static send(t,e=s,i){if(e[t])for(let s=e[t].length-1;s>=0;s--)if(void 0!==e[t]){if("function"!=typeof e[t][s]||!e[t][s])throw"Event handler is not a function.";e[t][s](...i)}}static unbindAll(t=s){for(const e in t)delete t[e];return!0}constructor(){this.listeners={}}on(t,e){r.on(t,e,this.listeners)}off(t,e){r.off(t,e,this.listeners)}trigger(t){var e=new Array(...arguments);e.splice(0,1),r.send(t,this.listeners,e)}unbindAll(){r.on(this.listeners)}}i.d(e,"default",function(){return h});const n=20;class h extends r{constructor(){super(),this.tickLength=n,this.startTime=Date.now(),this.started=!1,this.currentTime=Date.now(),this.waitForInput=!1,this.loop=!0,this.length=1e3,this._speed=1,this._schedule=[],this._currentSchedule=[],this.playing=!1,this.recording=!1,this.looped=-1}set speed(t){this._speed=t}get speed(){return this._speed}serialize(){let t=[];return this._schedule.map(e=>{t.push(JSON.stringify(e))}),JSON.stringify(t)}addToSchedule(t,e=this.time){this.waitForInput&&!this.started&&this.recording&&(this.started=!0,this.startTime=Date.now(),e=this.time);let i={timestamp:e,data:t};this._schedule.push(i),this.trigger("added",i)}reset(){const t=this._schedule.slice();return this._schedule=[],this._currentSchedule=[],this.length=1e3,t}record(t=!0){this.waitForInput=t,this.trigger("record"),this.startTime=Date.now(),this.recording=!0}play(){this.looped++,this.playing=!0,this._currentSchedule=this._schedule.slice(),this.startTime=Date.now(),this.currentTime=this.time,this.tick()}stop(){this.recording?(this.started=!1,this.length=this.time,this.recording=!1,this.trigger("endRecord",this.length)):this.trigger("end"),this.playing=!1}end(){this.loop?this.play():this.stop()}get timeRatio(){return this.globalTimeToLocal(Date.now())*this._speed/this.length}get time(){return this.timeRatio*this.length}tick(){if(this.timeRatio>1)return void this.end();this.playing&&setTimeout(this.tick.bind(this),this.tickLength);const t=this.processSchedule(this.time);this.trigger("tick",this.timeRatio,t),this.removeItemsFromSchedule(t)}seek(t){const e=this.length*t;this.startTime=Date.now()-e}globalTimeToLocal(t){return t-this.startTime}localTimeToGlobal(t){return t+this.startTime}processSchedule(t){return t<this.length?this.getEntriesToPlay(t):[]}getEntriesToPlay(t){return this._currentSchedule.filter(e=>e.timestamp<t+this.tickLength)}removeItemsFromSchedule(t){t.forEach(t=>{let e=this._currentSchedule.findIndex(e=>t===e);this._currentSchedule.splice(e,1)})}}}]);